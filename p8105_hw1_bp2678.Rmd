---
title: "Thesis"
author: "Brady Pham"
date: 2024-06-13
output: github_document
## 
---
```{r}
library(tidyverse)
```

```{r}
data <- read.csv("Thesis data.csv")

#Cleaning Education variable

data <- data %>%
  mutate(edu_bl = case_when(
    edu_bl == "8th grade or less" ~ "Less than High School",
    edu_bl == "Some high school, no diploma or GED" ~ "Less than High School",
    edu_bl == "Some college, no degree (including currently in college)" ~ "High school graduate/GED",
    edu_bl == "Some graduate work, no graduate degree" ~ "Bachelor's degree",
    edu_bl == "Bachelor's degree" ~ "Bachelor's degree",
    edu_bl == "Bachelorâ€™s degree" ~ "Bachelor's degree",
    TRUE ~ edu_bl 
  ))

#Cleaning Race Variable
data <- data %>%
  mutate(race = case_when( 
    race %in% c("American Indian", "Asian/Asian American", "Middle Eastern/North African") ~"Other",
    TRUE ~ race
    ))



race_education_table <- table(data$race, data$edu_bl)
print(race_education_table)



```



```{r}
#Income
filtered_data <- data %>%
  filter(income_bl != "Don't know" & income_bl != "Prefer not to answer")

race_income_table <- table(filtered_data$race, filtered_data$income_bl)
print(race_income_table)



```

```{r}
#Health status and race

data <- data %>%
  mutate(health_bl = case_when(
    health_bl == "Excellent" ~ "Good",
    health_bl == "Good" ~ "Good",
    health_bl == "Very Good" ~ "Good",
    health_bl == "Fair" ~ "Fair Poor",
    health_bl == "Poor" ~ "Fair Poor",
    TRUE ~ health_bl
  ))

health_race_table <- table(data$health_bl, data$race)
print(health_race_table)

```

```{r}

#Having insurance
data <- data %>%
  mutate(insurance_bl = case_when(
    insurance_bl %in% c("Yes, for all 6 months", "Yes, for part of the 6 months") ~ "Yes",
    TRUE ~ insurance_bl
      ))



insurance_race_table <- table(data$insurance_bl, data$race)
print(insurance_race_table)


```

```{r}

#Denied insurance
denied_insurance_data <- data |> 
  filter(insurance_denied_transcare_bl != "Don't know" & insurance_denied_transcare_bl != "You have not asked for this") |> 
  mutate(insurance_denied_transcare_bl = case_when(
    insurance_denied_transcare_bl %in% c("Yes, but not within the past 6 months","Yes, within the past 6 months") ~ "Yes",
    TRUE ~ insurance_denied_transcare_bl
  ))

insurance_denied_table <- table(denied_insurance_data$insurance_denied_transcare_bl, 
                                denied_insurance_data$race)
print(insurance_denied_table)

```

```{r}
#Helathcare discrimination 
data <- data |> 
  mutate(dscrm_hc_bl = case_when(
    dscrm_hc_bl %in% c("All or almost all of the time", "Don't know", "Most of the time", "Sometimes")
    ~ "Yes",
    TRUE ~ dscrm_hc_bl
  ))

Mistreatment_healthcare_table <- table(data$dscrm_hc_bl, data$race) 
print(Mistreatment_healthcare_table)

```

```{r}


data <- data |> 
  mutate(dr_denied_transcare_bl = case_when(
    dr_denied_transcare_bl %in% c("Yes, but not within the past 6 months", "Don't know", "Yes, within the past 6 months")
    ~ "Yes",
    TRUE ~ dr_denied_transcare_bl
  ))

Dr_denied_table <- table(data$dr_denied_transcare_bl, data$race)
print(Dr_denied_table)


```

```{r}

Everyday_discrm <- table(data$eds_bl, data$race)
print(Everyday_discrm)
  


```


