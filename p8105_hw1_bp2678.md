Thesis
================
Brady Pham
2024-06-13

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.3     ✔ readr     2.1.4
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.0
    ## ✔ ggplot2   3.4.3     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
data <- read.csv("Thesis data.csv")

#Cleaning Education variable

data <- data %>%
  mutate(edu_bl = case_when(
    edu_bl == "8th grade or less" ~ "Less than High School",
    edu_bl == "Some high school, no diploma or GED" ~ "Less than High School",
    edu_bl == "Some college, no degree (including currently in college)" ~ "High school graduate/GED",
    edu_bl == "Some graduate work, no graduate degree" ~ "Bachelor's degree",
    edu_bl == "Bachelor's degree" ~ "Bachelor's degree",
    edu_bl == "Bachelor’s degree" ~ "Bachelor's degree",
    TRUE ~ edu_bl 
  ))

#Cleaning Race Variable
data <- data %>%
  mutate(race = case_when( 
    race %in% c("American Indian", "Asian/Asian American", "Middle Eastern/North African") ~"Other",
    TRUE ~ race
    ))



race_education_table <- table(data$race, data$edu_bl)
print(race_education_table)
```

    ##                         
    ##                          Associate degree in college Bachelor's degree
    ##   Biracial/Multiracial                             6                 9
    ##   Black/African American                           8                 7
    ##   Latina/Latino/Hispanic                          10                12
    ##   Other                                            0                 3
    ##                         
    ##                          Graduate degree (Master’s/Doctoral/Professional degree)
    ##   Biracial/Multiracial                                                         3
    ##   Black/African American                                                       2
    ##   Latina/Latino/Hispanic                                                       0
    ##   Other                                                                        2
    ##                         
    ##                          High school graduate/GED Less than High School
    ##   Biracial/Multiracial                         26                    14
    ##   Black/African American                       61                    16
    ##   Latina/Latino/Hispanic                       56                    71
    ##   Other                                         4                     4

``` r
#Income
filtered_data <- data %>%
  filter(income_bl != "Don't know" & income_bl != "Prefer not to answer")

race_income_table <- table(filtered_data$race, filtered_data$income_bl)
print(race_income_table)
```

    ##                         
    ##                          $1 to  $9,999 $10,000 to  $29,999
    ##   Biracial/Multiracial              18                  16
    ##   Black/African American            29                  18
    ##   Latina/Latino/Hispanic            70                  34
    ##   Other                              6                   1
    ##                         
    ##                          $100,000 to  $149,999 $30,000 to  $49,999
    ##   Biracial/Multiracial                       1                   4
    ##   Black/African American                     1                   8
    ##   Latina/Latino/Hispanic                     0                   9
    ##   Other                                      1                   1
    ##                         
    ##                          $50,000 to  $74,999 $75,000 to  $99,999 No income
    ##   Biracial/Multiracial                     1                   2         6
    ##   Black/African American                   3                   2        19
    ##   Latina/Latino/Hispanic                   3                   0        25
    ##   Other                                    1                   0         1

``` r
#Health status and race

data <- data %>%
  mutate(health_bl = case_when(
    health_bl == "Excellent" ~ "Good",
    health_bl == "Good" ~ "Good",
    health_bl == "Very Good" ~ "Good",
    health_bl == "Fair" ~ "Fair Poor",
    health_bl == "Poor" ~ "Fair Poor",
    TRUE ~ health_bl
  ))

health_race_table <- table(data$health_bl, data$race)
print(health_race_table)
```

    ##            
    ##             Biracial/Multiracial Black/African American Latina/Latino/Hispanic
    ##   Fair Poor                   24                     16                     66
    ##   Good                        34                     78                     83
    ##            
    ##             Other
    ##   Fair Poor     4
    ##   Good          9

``` r
#Having insurance
data <- data %>%
  mutate(insurance_bl = case_when(
    insurance_bl %in% c("Yes, for all 6 months", "Yes, for part of the 6 months") ~ "Yes",
    TRUE ~ insurance_bl
      ))



insurance_race_table <- table(data$insurance_bl, data$race)
print(insurance_race_table)
```

    ##      
    ##       Biracial/Multiracial Black/African American Latina/Latino/Hispanic Other
    ##   No                     5                      7                     14     1
    ##   Yes                   53                     87                    135    12

``` r
#Denied insurance
denied_insurance_data <- data |> 
  filter(insurance_denied_transcare_bl != "Don't know" & insurance_denied_transcare_bl != "You have not asked for this") |> 
  mutate(insurance_denied_transcare_bl = case_when(
    insurance_denied_transcare_bl %in% c("Yes, but not within the past 6 months","Yes, within the past 6 months") ~ "Yes",
    TRUE ~ insurance_denied_transcare_bl
  ))

insurance_denied_table <- table(denied_insurance_data$insurance_denied_transcare_bl, 
                                denied_insurance_data$race)
print(insurance_denied_table)
```

    ##            
    ##             Biracial/Multiracial Black/African American Latina/Latino/Hispanic
    ##   No, never                   37                     65                     88
    ##   Yes                         12                     12                     33
    ##            
    ##             Other
    ##   No, never     7
    ##   Yes           3

``` r
#Helathcare discrimination 
data <- data |> 
  mutate(dscrm_hc_bl = case_when(
    dscrm_hc_bl %in% c("All or almost all of the time", "Don't know", "Most of the time", "Sometimes")
    ~ "Yes",
    TRUE ~ dscrm_hc_bl
  ))

Mistreatment_healthcare_table <- table(data$dscrm_hc_bl, data$race) 
print(Mistreatment_healthcare_table)
```

    ##        
    ##         Biracial/Multiracial Black/African American Latina/Latino/Hispanic
    ##   Never                   39                     62                    118
    ##   Yes                     19                     32                     31
    ##        
    ##         Other
    ##   Never    10
    ##   Yes       3

``` r
data <- data |> 
  mutate(dr_denied_transcare_bl = case_when(
    dr_denied_transcare_bl %in% c("Yes, but not within the past 6 months", "Don't know", "Yes, within the past 6 months")
    ~ "Yes",
    TRUE ~ dr_denied_transcare_bl
  ))

Dr_denied_table <- table(data$dr_denied_transcare_bl, data$race)
print(Dr_denied_table)
```

    ##            
    ##             Biracial/Multiracial Black/African American Latina/Latino/Hispanic
    ##   No, never                   47                     79                    130
    ##   Yes                         11                     15                     19
    ##            
    ##             Other
    ##   No, never    12
    ##   Yes           1

``` r
Everyday_discrm <- table(data$eds_bl, data$race)
print(Everyday_discrm)
```

    ##         
    ##          Biracial/Multiracial Black/African American Latina/Latino/Hispanic
    ##   High                     17                     29                     34
    ##   Low                      10                     31                     46
    ##   Medium                   31                     34                     69
    ##         
    ##          Other
    ##   High       6
    ##   Low        1
    ##   Medium     6
