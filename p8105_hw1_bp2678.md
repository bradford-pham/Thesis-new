Thesis
================
Brady Pham
2024-06-13

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.3     ✔ readr     2.1.4
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.0
    ## ✔ ggplot2   3.4.3     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(dplyr)
library(epitools)
```

``` r
data <- read.csv("Thesis data.csv")

#Cleaning Education variable

data <- data %>%
  mutate(edu_bl = case_when(
    edu_bl == "8th grade or less" ~ "Less than High School",
    edu_bl == "Some high school, no diploma or GED" ~ "Less than High School",
    edu_bl == "Some college, no degree (including currently in college)" ~ "High school graduate/GED",
    edu_bl == "Some graduate work, no graduate degree" ~ "Bachelor's degree",
    edu_bl == "Bachelor's degree" ~ "Bachelor's degree",
    edu_bl == "Bachelor’s degree" ~ "Bachelor's degree",
    TRUE ~ edu_bl 
  ))

#Cleaning Race Variable
data <- data %>%
  mutate(race = case_when( 
    race %in% c("American Indian", "Asian/Asian American", "Middle Eastern/North African") ~"Other",
    TRUE ~ race
    ))
race_education_table <- table(data$race, data$edu_bl)
print(race_education_table)
```

    ##                         
    ##                          Associate degree in college Bachelor's degree
    ##   Biracial/Multiracial                             6                 9
    ##   Black/African American                           8                 7
    ##   Latina/Latino/Hispanic                          10                12
    ##   Other                                            0                 3
    ##                         
    ##                          Graduate degree (Master’s/Doctoral/Professional degree)
    ##   Biracial/Multiracial                                                         3
    ##   Black/African American                                                       2
    ##   Latina/Latino/Hispanic                                                       0
    ##   Other                                                                        2
    ##                         
    ##                          High school graduate/GED Less than High School
    ##   Biracial/Multiracial                         26                    14
    ##   Black/African American                       61                    16
    ##   Latina/Latino/Hispanic                       56                    71
    ##   Other                                         4                     4

``` r
#Income table
filtered_data <- data %>%
  filter(income_bl != "Don't know" & income_bl != "Prefer not to answer")

race_income_table <- table(filtered_data$race, filtered_data$income_bl)
print(race_income_table)
```

    ##                         
    ##                          $1 to  $9,999 $10,000 to  $29,999
    ##   Biracial/Multiracial              18                  16
    ##   Black/African American            29                  18
    ##   Latina/Latino/Hispanic            70                  34
    ##   Other                              6                   1
    ##                         
    ##                          $100,000 to  $149,999 $30,000 to  $49,999
    ##   Biracial/Multiracial                       1                   4
    ##   Black/African American                     1                   8
    ##   Latina/Latino/Hispanic                     0                   9
    ##   Other                                      1                   1
    ##                         
    ##                          $50,000 to  $74,999 $75,000 to  $99,999 No income
    ##   Biracial/Multiracial                     1                   2         6
    ##   Black/African American                   3                   2        19
    ##   Latina/Latino/Hispanic                   3                   0        25
    ##   Other                                    1                   0         1

``` r
#income and race odds ratio and income

odds_ratio_income <- oddsratio(race_income_table)
```

    ## Warning in chisq.test(xx, correct = correction): Chi-squared approximation may
    ## be incorrect

    ## Warning in chisq.test(xx, correct = correction): Chi-squared approximation may
    ## be incorrect

    ## Warning in chisq.test(xx, correct = correction): Chi-squared approximation may
    ## be incorrect

``` r
print(odds_ratio_income)
```

    ## $data
    ##                         
    ##                          $1 to  $9,999 $10,000 to  $29,999
    ##   Biracial/Multiracial              18                  16
    ##   Black/African American            29                  18
    ##   Latina/Latino/Hispanic            70                  34
    ##   Other                              6                   1
    ##   Total                            123                  69
    ##                         
    ##                          $100,000 to  $149,999 $30,000 to  $49,999
    ##   Biracial/Multiracial                       1                   4
    ##   Black/African American                     1                   8
    ##   Latina/Latino/Hispanic                     0                   9
    ##   Other                                      1                   1
    ##   Total                                      3                  22
    ##                         
    ##                          $50,000 to  $74,999 $75,000 to  $99,999 No income
    ##   Biracial/Multiracial                     1                   2         6
    ##   Black/African American                   3                   2        19
    ##   Latina/Latino/Hispanic                   3                   0        25
    ##   Other                                    1                   0         1
    ##   Total                                    8                   4        51
    ##                         
    ##                          Total
    ##   Biracial/Multiracial      48
    ##   Black/African American    80
    ##   Latina/Latino/Hispanic   141
    ##   Other                     11
    ##   Total                    280
    ## 
    ## $measure
    ##                         odds ratio with 95% C.I.
    ##                           estimate       lower    upper
    ##   Biracial/Multiracial   1.0000000          NA       NA
    ##   Black/African American 0.7019700 0.282594010 1.732306
    ##   Latina/Latino/Hispanic 0.5488213 0.247128105 1.221191
    ##   Other                  0.2139144 0.007655953 1.501677
    ## 
    ## $p.value
    ##                         two-sided
    ##                          midp.exact fisher.exact chi.square
    ##   Biracial/Multiracial           NA           NA         NA
    ##   Black/African American  0.4420183   0.63615411 0.67155931
    ##   Latina/Latino/Hispanic  0.1404478   0.07228019 0.06439226
    ##   Other                   0.1325660   0.30789695 0.46833695
    ## 
    ## $correction
    ## [1] FALSE
    ## 
    ## attr(,"method")
    ## [1] "median-unbiased estimate & mid-p exact CI"

``` r
chi_square_test_income <- chisq.test(race_income_table)
```

    ## Warning in chisq.test(race_income_table): Chi-squared approximation may be
    ## incorrect

``` r
print(chi_square_test_income)
```

    ## 
    ##  Pearson's Chi-squared test
    ## 
    ## data:  race_income_table
    ## X-squared = 25.204, df = 18, p-value = 0.1194

``` r
#Health status and race table

data <- data %>%
  mutate(health_bl = case_when(
    health_bl == "Excellent" ~ "Good",
    health_bl == "Good" ~ "Good",
    health_bl == "Very Good" ~ "Good",
    health_bl == "Fair" ~ "Fair Poor",
    health_bl == "Poor" ~ "Fair Poor",
    TRUE ~ health_bl
  ))

health_race_table <- table(data$health_bl, data$race)
print(health_race_table)
```

    ##            
    ##             Biracial/Multiracial Black/African American Latina/Latino/Hispanic
    ##   Fair Poor                   24                     16                     66
    ##   Good                        34                     78                     83
    ##            
    ##             Other
    ##   Fair Poor     4
    ##   Good          9

``` r
#Health status and race odds ratio and chi square

odds_ratio_health <- oddsratio(health_race_table)
```

    ## Warning in chisq.test(xx, correct = correction): Chi-squared approximation may
    ## be incorrect

``` r
print(odds_ratio_health)
```

    ## $data
    ##            
    ##             Biracial/Multiracial Black/African American Latina/Latino/Hispanic
    ##   Fair Poor                   24                     16                     66
    ##   Good                        34                     78                     83
    ##   Total                       58                     94                    149
    ##            
    ##             Other Total
    ##   Fair Poor     4   110
    ##   Good          9   204
    ##   Total        13   314
    ## 
    ## $measure
    ##            odds ratio with 95% C.I.
    ##             estimate    lower   upper
    ##   Fair Poor 1.000000       NA      NA
    ##   Good      3.399993 1.613334 7.35416
    ## 
    ## $p.value
    ##            two-sided
    ##              midp.exact fisher.exact  chi.square
    ##   Fair Poor          NA           NA          NA
    ##   Good      0.001240334 7.052379e-05 0.000158338
    ## 
    ## $correction
    ## [1] FALSE
    ## 
    ## attr(,"method")
    ## [1] "median-unbiased estimate & mid-p exact CI"

``` r
chi_square_test_health <- chisq.test(health_race_table)
```

    ## Warning in chisq.test(health_race_table): Chi-squared approximation may be
    ## incorrect

``` r
print(chi_square_test_health)
```

    ## 
    ##  Pearson's Chi-squared test
    ## 
    ## data:  health_race_table
    ## X-squared = 20.146, df = 3, p-value = 0.0001583

``` r
#Having insurance and race
data <- data %>%
  mutate(insurance_bl = case_when(
    insurance_bl %in% c("Yes, for all 6 months", "Yes, for part of the 6 months") ~ "Yes",
    TRUE ~ insurance_bl
      ))



insurance_race_table <- table(data$insurance_bl, data$race)
print(insurance_race_table)
```

    ##      
    ##       Biracial/Multiracial Black/African American Latina/Latino/Hispanic Other
    ##   No                     5                      7                     14     1
    ##   Yes                   53                     87                    135    12

``` r
#Having insurance and race odds ratio and chi square
odds_ratio_insurance <- oddsratio(insurance_race_table)
```

    ## Warning in chisq.test(xx, correct = correction): Chi-squared approximation may
    ## be incorrect

``` r
print(odds_ratio_insurance)
```

    ## $data
    ##        
    ##         Biracial/Multiracial Black/African American Latina/Latino/Hispanic
    ##   No                       5                      7                     14
    ##   Yes                     53                     87                    135
    ##   Total                   58                     94                    149
    ##        
    ##         Other Total
    ##   No        1    27
    ##   Yes      12   287
    ##   Total    13   314
    ## 
    ## $measure
    ##      odds ratio with 95% C.I.
    ##       estimate     lower   upper
    ##   No  1.000000        NA      NA
    ##   Yes 1.180694 0.3247745 3.97849
    ## 
    ## $p.value
    ##      two-sided
    ##       midp.exact fisher.exact chi.square
    ##   No          NA           NA         NA
    ##   Yes  0.7910482    0.9590313  0.9613717
    ## 
    ## $correction
    ## [1] FALSE
    ## 
    ## attr(,"method")
    ## [1] "median-unbiased estimate & mid-p exact CI"

``` r
chi_square_test_insurance <- chisq.test(insurance_race_table)
```

    ## Warning in chisq.test(insurance_race_table): Chi-squared approximation may be
    ## incorrect

``` r
print(chi_square_test_insurance)
```

    ## 
    ##  Pearson's Chi-squared test
    ## 
    ## data:  insurance_race_table
    ## X-squared = 0.29283, df = 3, p-value = 0.9614

``` r
#Denied insurance and race table 
denied_insurance_data <- data |> 
  filter(insurance_denied_transcare_bl != "Don't know" & insurance_denied_transcare_bl != "You have not asked for this") |> 
  mutate(insurance_denied_transcare_bl = case_when(
    insurance_denied_transcare_bl %in% c("Yes, but not within the past 6 months","Yes, within the past 6 months") ~ "Yes",
    TRUE ~ insurance_denied_transcare_bl
  ))

insurance_denied_table <- table(denied_insurance_data$insurance_denied_transcare_bl, 
                                denied_insurance_data$race)
print(insurance_denied_table)
```

    ##            
    ##             Biracial/Multiracial Black/African American Latina/Latino/Hispanic
    ##   No, never                   37                     65                     88
    ##   Yes                         12                     12                     33
    ##            
    ##             Other
    ##   No, never     7
    ##   Yes           3

``` r
#Denied insurance and race odds ratio and chi square
odds_ratio_denied <- oddsratio(insurance_denied_table)
```

    ## Warning in chisq.test(xx, correct = correction): Chi-squared approximation may
    ## be incorrect

``` r
print(odds_ratio_denied)
```

    ## $data
    ##            
    ##             Biracial/Multiracial Black/African American Latina/Latino/Hispanic
    ##   No, never                   37                     65                     88
    ##   Yes                         12                     12                     33
    ##   Total                       49                     77                    121
    ##            
    ##             Other Total
    ##   No, never     7   197
    ##   Yes           3    60
    ##   Total        10   257
    ## 
    ## $measure
    ##            odds ratio with 95% C.I.
    ##             estimate     lower    upper
    ##   No, never 1.000000        NA       NA
    ##   Yes       0.572054 0.2290839 1.424639
    ## 
    ## $p.value
    ##            two-sided
    ##             midp.exact fisher.exact chi.square
    ##   No, never         NA           NA         NA
    ##   Yes        0.2280349    0.2351148  0.2704772
    ## 
    ## $correction
    ## [1] FALSE
    ## 
    ## attr(,"method")
    ## [1] "median-unbiased estimate & mid-p exact CI"

``` r
chi_square_test_denied <- chisq.test(insurance_denied_table)
```

    ## Warning in chisq.test(insurance_denied_table): Chi-squared approximation may be
    ## incorrect

``` r
print(chi_square_test_denied)
```

    ## 
    ##  Pearson's Chi-squared test
    ## 
    ## data:  insurance_denied_table
    ## X-squared = 3.9178, df = 3, p-value = 0.2705

``` r
#Helathcare discrimination and race table
data <- data |> 
  mutate(dscrm_hc_bl = case_when(
    dscrm_hc_bl %in% c("All or almost all of the time", "Don't know", "Most of the time", "Sometimes")
    ~ "Yes",
    TRUE ~ dscrm_hc_bl
  ))

Mistreatment_healthcare_table <- table(data$dscrm_hc_bl, data$race) 
print(Mistreatment_healthcare_table)
```

    ##        
    ##         Biracial/Multiracial Black/African American Latina/Latino/Hispanic
    ##   Never                   39                     62                    118
    ##   Yes                     19                     32                     31
    ##        
    ##         Other
    ##   Never    10
    ##   Yes       3

``` r
#healthcare discrimination and race odds ratio and chisquare
odds_ratio_mistreatment <- oddsratio(Mistreatment_healthcare_table)
```

    ## Warning in chisq.test(xx, correct = correction): Chi-squared approximation may
    ## be incorrect

``` r
print(odds_ratio_mistreatment)
```

    ## $data
    ##        
    ##         Biracial/Multiracial Black/African American Latina/Latino/Hispanic
    ##   Never                   39                     62                    118
    ##   Yes                     19                     32                     31
    ##   Total                   58                     94                    149
    ##        
    ##         Other Total
    ##   Never    10   229
    ##   Yes       3    85
    ##   Total    13   314
    ## 
    ## $measure
    ##        odds ratio with 95% C.I.
    ##         estimate    lower    upper
    ##   Never 1.000000       NA       NA
    ##   Yes   1.057092 0.528043 2.148358
    ## 
    ## $p.value
    ##        two-sided
    ##         midp.exact fisher.exact chi.square
    ##   Never         NA           NA         NA
    ##   Yes    0.8761419   0.09082356 0.09650772
    ## 
    ## $correction
    ## [1] FALSE
    ## 
    ## attr(,"method")
    ## [1] "median-unbiased estimate & mid-p exact CI"

``` r
chi_square_test_mistreatment <- chisq.test(Mistreatment_healthcare_table)
```

    ## Warning in chisq.test(Mistreatment_healthcare_table): Chi-squared approximation
    ## may be incorrect

``` r
print(chi_square_test_mistreatment)
```

    ## 
    ##  Pearson's Chi-squared test
    ## 
    ## data:  Mistreatment_healthcare_table
    ## X-squared = 6.3325, df = 3, p-value = 0.09651

``` r
#Dr denied and race table
data <- data |> 
  mutate(dr_denied_transcare_bl = case_when(
    dr_denied_transcare_bl %in% c("Yes, but not within the past 6 months", "Don't know", "Yes, within the past 6 months")
    ~ "Yes",
    TRUE ~ dr_denied_transcare_bl
  ))

Dr_denied_table <- table(data$dr_denied_transcare_bl, data$race)
print(Dr_denied_table)
```

    ##            
    ##             Biracial/Multiracial Black/African American Latina/Latino/Hispanic
    ##   No, never                   47                     79                    130
    ##   Yes                         11                     15                     19
    ##            
    ##             Other
    ##   No, never    12
    ##   Yes           1

``` r
#Dr denied and race odds ratio and chi square 
odds_ratio_dr_denied <- oddsratio(Dr_denied_table)
```

    ## Warning in chisq.test(xx, correct = correction): Chi-squared approximation may
    ## be incorrect

``` r
print(odds_ratio_dr_denied)
```

    ## $data
    ##            
    ##             Biracial/Multiracial Black/African American Latina/Latino/Hispanic
    ##   No, never                   47                     79                    130
    ##   Yes                         11                     15                     19
    ##   Total                       58                     94                    149
    ##            
    ##             Other Total
    ##   No, never    12   268
    ##   Yes           1    46
    ##   Total        13   314
    ## 
    ## $measure
    ##            odds ratio with 95% C.I.
    ##              estimate     lower    upper
    ##   No, never 1.0000000        NA       NA
    ##   Yes       0.8100323 0.3423165 1.966575
    ## 
    ## $p.value
    ##            two-sided
    ##             midp.exact fisher.exact chi.square
    ##   No, never         NA           NA         NA
    ##   Yes        0.6350142    0.6305643  0.5880862
    ## 
    ## $correction
    ## [1] FALSE
    ## 
    ## attr(,"method")
    ## [1] "median-unbiased estimate & mid-p exact CI"

``` r
chi_square_test_dr_denied <- chisq.test(Dr_denied_table)
```

    ## Warning in chisq.test(Dr_denied_table): Chi-squared approximation may be
    ## incorrect

``` r
print(chi_square_test_dr_denied)
```

    ## 
    ##  Pearson's Chi-squared test
    ## 
    ## data:  Dr_denied_table
    ## X-squared = 1.9252, df = 3, p-value = 0.5881
